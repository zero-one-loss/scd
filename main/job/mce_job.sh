#!/bin/bash -l
#SBATCH -p datasci3,datasci4,datasci
#SBATCH --job-name=cifar10_${seed}1
#SBATCH --gres=gpu:1
#SBATCH --mem=16G
#SBATCH --cpus-per-task=1
cd ..
gpu=0


seed=0

#  traditional toy3 with back-propagation
python train_bp.py --aug 1 --n_classes 10 --no_bias 1 --seed $seed --version toy3rrr100 --lr 0.001 --target cifar10_toy3rrr100_nb2_mce_bp_${seed}

#  training for BAN
python train_bp.py --aug 1 --n_classes 10 --no_bias 1 --seed $seed --version toy3srr100scale --lr 0.001 --target cifar10_toy3srr100scale_nb2_mce_bp_${seed}
python train_bp.py --aug 1 --n_classes 10 --no_bias 1 --seed $seed --version toy3ssr100scale --lr 0.001 --target cifar10_toy3ssr100scale_nb2_mce_bp_${seed}
python train_bp.py --aug 1 --n_classes 10 --no_bias 1 --seed $seed --version toy3sss100scale --lr 0.001 --target cifar10_toy3sss100scale_nb2_mce_bp_${seed}
python train_bp.py --aug 1 --n_classes 10 --no_bias 1 --seed $seed --version toy3ssss100scale --lr 0.001 --target cifar10_toy3ssss100scale_nb2_mce_bp_${seed}

# ABP training for mce
python train_cnn01_abp_ce.py --nrows 0.004 --localit 1 --updated_conv_features 32 --updated_fc_features 128 --updated_fc_nodes 1 --updated_conv_nodes 1 --width 100 --normalize 0 --percentile 1 --fail_count 1 --loss mce --act sign --fc_diversity 1 --init normal --no_bias 2 --scale 1 --w-inc1 0.0045 --w-inc2 0.1 --version toy3srr100scale --seed $seed --iters 30000 --dataset cifar10 --n_classes 10 --cnn 1 --divmean 0 --target cifar10_toy3srr100scale_abp_sign_i1_mce_b200_lrc0.0045_lrf0.1_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed} --updated_fc_ratio 10 --updated_conv_ratio 20 --verbose_iter 500 --freeze_layer 0 --lr 0.001 --bp_layer 4 --aug 1
python train_cnn01_abp_ce.py --nrows 0.004 --localit 1 --updated_conv_features 32 --updated_fc_features 128 --updated_fc_nodes 1 --updated_conv_nodes 1 --width 100 --normalize 0 --percentile 1 --fail_count 1 --loss mce --act sign --fc_diversity 1 --init normal --no_bias 2 --scale 1 --w-inc1 0.0045 --w-inc2 0.05 --version toy3ssr100scale --seed $seed --iters 30000 --dataset cifar10 --n_classes 10 --cnn 1 --divmean 0 --target cifar10_toy3ssr100scale_abp_sign_i1_mce_b200_lrc0.0045_lrf0.05_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed} --updated_fc_ratio 10 --updated_conv_ratio 20 --verbose_iter 500 --freeze_layer 1 --resume --source cifar10_toy3srr100scale_abp_sign_i1_mce_b200_lrc0.0045_lrf0.1_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed} --lr 0.001 --bp_layer 3  --aug 1  --reinit 3
python train_cnn01_abp_ce.py --nrows 0.004 --localit 1 --updated_conv_features 32 --updated_fc_features 128 --updated_fc_nodes 1 --updated_conv_nodes 1 --width 100 --normalize 0 --percentile 1 --fail_count 1 --loss mce --act sign --fc_diversity 1 --init normal --no_bias 2 --scale 1 --w-inc1 0.05 --w-inc2 0.05 --version toy3sss100scale --seed $seed --iters 30000 --dataset cifar10 --n_classes 10 --cnn 1 --divmean 0 --target cifar10_toy3sss100scale_abp_sign_i1_mce_b200_lrc0.05_lrf0.05_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed} --updated_fc_ratio 10 --updated_conv_ratio 20 --verbose_iter 500 --freeze_layer 2 --resume --source cifar10_toy3ssr100scale_abp_sign_i1_mce_b200_lrc0.0045_lrf0.05_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed}  --lr 0.001 --bp_layer 2  --aug 1  --reinit 2
python train_cnn01_abp_ce.py --nrows 0.004 --localit 1 --updated_conv_features 32 --updated_fc_features 128 --updated_fc_nodes 1 --updated_conv_nodes 1 --width 100 --normalize 0 --percentile 1 --fail_count 1 --loss mce --act sign --fc_diversity 1 --init normal --no_bias 2 --scale 1 --w-inc1 0.05 --w-inc2 0.7 --version toy3ssss100scale --seed $seed --iters 30000 --dataset cifar10 --n_classes 10 --cnn 1 --divmean 0 --target cifar10_toy3ssss100scale_abp_sign_i1_mce_b200_lrc0.05_lrf0.7_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed} --updated_fc_ratio 10 --updated_conv_ratio 20 --verbose_iter 500 --freeze_layer 3 --resume --source cifar10_toy3sss100scale_abp_sign_i1_mce_b200_lrc0.05_lrf0.05_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed} --lr 0.001 --bp_layer 1  --aug 1  --reinit 1

# ABP training for 01loss
python train_cnn01_abp_ce.py --nrows 0.004 --localit 1 --updated_conv_features 32 --updated_fc_features 128 --updated_fc_nodes 1 --updated_conv_nodes 1 --width 100 --normalize 0 --percentile 1 --fail_count 1 --loss 01loss --act sign --fc_diversity 1 --init normal --no_bias 2 --scale 1 --w-inc1 0.0045 --w-inc2 0.1 --version toy3srr100scale --seed $seed --iters 30000 --dataset cifar10 --n_classes 10 --cnn 1 --divmean 0 --target cifar10_toy3srr100scale_abp_sign_i1_01loss_b200_lrc0.0045_lrf0.1_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed} --updated_fc_ratio 10 --updated_conv_ratio 20 --verbose_iter 500 --freeze_layer 0 --lr 0.001 --bp_layer 4 --aug 1
python train_cnn01_abp_ce.py --nrows 0.004 --localit 1 --updated_conv_features 32 --updated_fc_features 128 --updated_fc_nodes 1 --updated_conv_nodes 1 --width 100 --normalize 0 --percentile 1 --fail_count 1 --loss 01loss --act sign --fc_diversity 1 --init normal --no_bias 2 --scale 1 --w-inc1 0.0045 --w-inc2 0.05 --version toy3ssr100scale --seed $seed --iters 30000 --dataset cifar10 --n_classes 10 --cnn 1 --divmean 0 --target cifar10_toy3ssr100scale_abp_sign_i1_01loss_b200_lrc0.0045_lrf0.05_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed} --updated_fc_ratio 10 --updated_conv_ratio 20 --verbose_iter 500 --freeze_layer 1 --resume --source cifar10_toy3srr100scale_abp_sign_i1_01loss_b200_lrc0.0045_lrf0.1_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed} --lr 0.001 --bp_layer 3  --aug 1  --reinit 3
python train_cnn01_abp_ce.py --nrows 0.004 --localit 1 --updated_conv_features 32 --updated_fc_features 128 --updated_fc_nodes 1 --updated_conv_nodes 1 --width 100 --normalize 0 --percentile 1 --fail_count 1 --loss 01loss --act sign --fc_diversity 1 --init normal --no_bias 2 --scale 1 --w-inc1 0.05 --w-inc2 0.05 --version toy3sss100scale --seed $seed --iters 30000 --dataset cifar10 --n_classes 10 --cnn 1 --divmean 0 --target cifar10_toy3sss100scale_abp_sign_i1_01loss_b200_lrc0.05_lrf0.05_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed} --updated_fc_ratio 10 --updated_conv_ratio 20 --verbose_iter 500 --freeze_layer 2 --resume --source cifar10_toy3ssr100scale_abp_sign_i1_01loss_b200_lrc0.0045_lrf0.05_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed}  --lr 0.001 --bp_layer 2  --aug 1  --reinit 2
python train_cnn01_abp_ce.py --nrows 0.004 --localit 1 --updated_conv_features 32 --updated_fc_features 128 --updated_fc_nodes 1 --updated_conv_nodes 1 --width 100 --normalize 0 --percentile 1 --fail_count 1 --loss 01loss --act sign --fc_diversity 1 --init normal --no_bias 2 --scale 1 --w-inc1 0.05 --w-inc2 0.7 --version toy3ssss100scale --seed $seed --iters 30000 --dataset cifar10 --n_classes 10 --cnn 1 --divmean 0 --target cifar10_toy3ssss100scale_abp_sign_i1_01loss_b200_lrc0.05_lrf0.7_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed} --updated_fc_ratio 10 --updated_conv_ratio 20 --verbose_iter 500 --freeze_layer 3 --resume --source cifar10_toy3sss100scale_abp_sign_i1_01loss_b200_lrc0.05_lrf0.05_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed} --lr 0.001 --bp_layer 1  --aug 1  --reinit 1


# ABP adversarial training for mce
python train_cnn01_abp_ce.py --nrows 0.004 --localit 1 --updated_conv_features 32 --updated_fc_features 128 --updated_fc_nodes 1 --updated_conv_nodes 1 --width 100 --normalize 0 --percentile 1 --fail_count 1 --loss mce --act sign --fc_diversity 1 --init normal --no_bias 2 --scale 1 --w-inc1 0.0045 --w-inc2 0.1 --version toy3srr100scale --seed $seed --iters 30000 --dataset cifar10 --n_classes 10 --cnn 1 --divmean 0 --target cifar10_toy3srr100scale_abp_adv_sign_i1_mce_b200_lrc0.0045_lrf0.1_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed} --updated_fc_ratio 10 --updated_conv_ratio 20 --verbose_iter 500 --freeze_layer 0 --lr 0.001 --bp_layer 4 --aug 1 --adv_train 1
python train_cnn01_abp_ce.py --nrows 0.004 --localit 1 --updated_conv_features 32 --updated_fc_features 128 --updated_fc_nodes 1 --updated_conv_nodes 1 --width 100 --normalize 0 --percentile 1 --fail_count 1 --loss mce --act sign --fc_diversity 1 --init normal --no_bias 2 --scale 1 --w-inc1 0.0045 --w-inc2 0.05 --version toy3ssr100scale --seed $seed --iters 30000 --dataset cifar10 --n_classes 10 --cnn 1 --divmean 0 --target cifar10_toy3ssr100scale_abp_adv_sign_i1_mce_b200_lrc0.0045_lrf0.05_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed} --updated_fc_ratio 10 --updated_conv_ratio 20 --verbose_iter 500 --freeze_layer 1 --resume --source cifar10_toy3srr100scale_abp_adv_sign_i1_mce_b200_lrc0.0045_lrf0.1_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed} --lr 0.001 --bp_layer 3  --aug 1  --reinit 3 --adv_train 1 
python train_cnn01_abp_ce.py --nrows 0.004 --localit 1 --updated_conv_features 32 --updated_fc_features 128 --updated_fc_nodes 1 --updated_conv_nodes 1 --width 100 --normalize 0 --percentile 1 --fail_count 1 --loss mce --act sign --fc_diversity 1 --init normal --no_bias 2 --scale 1 --w-inc1 0.05 --w-inc2 0.05 --version toy3sss100scale --seed $seed --iters 30000 --dataset cifar10 --n_classes 10 --cnn 1 --divmean 0 --target cifar10_toy3sss100scale_abp_adv_sign_i1_mce_b200_lrc0.05_lrf0.05_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed} --updated_fc_ratio 10 --updated_conv_ratio 20 --verbose_iter 500 --freeze_layer 2 --resume --source cifar10_toy3ssr100scale_abp_adv_sign_i1_mce_b200_lrc0.0045_lrf0.05_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed}  --lr 0.001 --bp_layer 2  --aug 1  --reinit 2 --adv_train 1 
python train_cnn01_abp_ce.py --nrows 0.004 --localit 1 --updated_conv_features 32 --updated_fc_features 128 --updated_fc_nodes 1 --updated_conv_nodes 1 --width 100 --normalize 0 --percentile 1 --fail_count 1 --loss mce --act sign --fc_diversity 1 --init normal --no_bias 2 --scale 1 --w-inc1 0.05 --w-inc2 0.7 --version toy3ssss100scale --seed $seed --iters 30000 --dataset cifar10 --n_classes 10 --cnn 1 --divmean 0 --target cifar10_toy3ssss100scale_abp_adv_sign_i1_mce_b200_lrc0.05_lrf0.7_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed} --updated_fc_ratio 10 --updated_conv_ratio 20 --verbose_iter 500 --freeze_layer 3 --resume --source cifar10_toy3sss100scale_abp_adv_sign_i1_mce_b200_lrc0.05_lrf0.05_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed} --lr 0.001 --bp_layer 1  --aug 1 --reinit 1 --adv_train 1 

# ABP adversarial training for 01loss
python train_cnn01_abp_ce.py --nrows 0.004 --localit 1 --updated_conv_features 32 --updated_fc_features 128 --updated_fc_nodes 1 --updated_conv_nodes 1 --width 100 --normalize 0 --percentile 1 --fail_count 1 --loss 01loss --act sign --fc_diversity 1 --init normal --no_bias 2 --scale 1 --w-inc1 0.0045 --w-inc2 0.1 --version toy3srr100scale --seed $seed --iters 30000 --dataset cifar10 --n_classes 10 --cnn 1 --divmean 0 --target cifar10_toy3srr100scale_abp_adv_sign_i1_01loss_b200_lrc0.0045_lrf0.1_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed} --updated_fc_ratio 10 --updated_conv_ratio 20 --verbose_iter 500 --freeze_layer 0 --lr 0.001 --bp_layer 4 --aug 1 --adv_train 1
python train_cnn01_abp_ce.py --nrows 0.004 --localit 1 --updated_conv_features 32 --updated_fc_features 128 --updated_fc_nodes 1 --updated_conv_nodes 1 --width 100 --normalize 0 --percentile 1 --fail_count 1 --loss 01loss --act sign --fc_diversity 1 --init normal --no_bias 2 --scale 1 --w-inc1 0.0045 --w-inc2 0.05 --version toy3ssr100scale --seed $seed --iters 30000 --dataset cifar10 --n_classes 10 --cnn 1 --divmean 0 --target cifar10_toy3ssr100scale_abp_adv_sign_i1_01loss_b200_lrc0.0045_lrf0.05_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed} --updated_fc_ratio 10 --updated_conv_ratio 20 --verbose_iter 500 --freeze_layer 1 --resume --source cifar10_toy3srr100scale_abp_adv_sign_i1_01loss_b200_lrc0.0045_lrf0.1_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed} --lr 0.001 --bp_layer 3  --aug 1  --reinit 3 --adv_train 1 
python train_cnn01_abp_ce.py --nrows 0.004 --localit 1 --updated_conv_features 32 --updated_fc_features 128 --updated_fc_nodes 1 --updated_conv_nodes 1 --width 100 --normalize 0 --percentile 1 --fail_count 1 --loss 01loss --act sign --fc_diversity 1 --init normal --no_bias 2 --scale 1 --w-inc1 0.05 --w-inc2 0.05 --version toy3sss100scale --seed $seed --iters 30000 --dataset cifar10 --n_classes 10 --cnn 1 --divmean 0 --target cifar10_toy3sss100scale_abp_adv_sign_i1_01loss_b200_lrc0.05_lrf0.05_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed} --updated_fc_ratio 10 --updated_conv_ratio 20 --verbose_iter 500 --freeze_layer 2 --resume --source cifar10_toy3ssr100scale_abp_adv_sign_i1_01loss_b200_lrc0.0045_lrf0.05_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed}  --lr 0.001 --bp_layer 2  --aug 1  --reinit 2 --adv_train 1 
python train_cnn01_abp_ce.py --nrows 0.004 --localit 1 --updated_conv_features 32 --updated_fc_features 128 --updated_fc_nodes 1 --updated_conv_nodes 1 --width 100 --normalize 0 --percentile 1 --fail_count 1 --loss 01loss --act sign --fc_diversity 1 --init normal --no_bias 2 --scale 1 --w-inc1 0.05 --w-inc2 0.7 --version toy3ssss100scale --seed $seed --iters 30000 --dataset cifar10 --n_classes 10 --cnn 1 --divmean 0 --target cifar10_toy3ssss100scale_abp_adv_sign_i1_01loss_b200_lrc0.05_lrf0.7_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed} --updated_fc_ratio 10 --updated_conv_ratio 20 --verbose_iter 500 --freeze_layer 3 --resume --source cifar10_toy3sss100scale_abp_adv_sign_i1_01loss_b200_lrc0.05_lrf0.05_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed} --lr 0.001 --bp_layer 1  --aug 1 --reinit 1 --adv_train 1 


# if you want to do 8 votes

for seed in {0..7}
do
#  traditional toy3 with back-propagation
python train_bp.py --aug 1 --n_classes 10 --no_bias 1 --seed $seed --version toy3rrr100 --lr 0.001 --target cifar10_toy3rrr100_nb2_mce_bp_${seed}

#  training for BAN
python train_bp.py --aug 1 --n_classes 10 --no_bias 1 --seed $seed --version toy3srr100scale --lr 0.001 --target cifar10_toy3srr100scale_nb2_mce_bp_${seed}
python train_bp.py --aug 1 --n_classes 10 --no_bias 1 --seed $seed --version toy3ssr100scale --lr 0.001 --target cifar10_toy3ssr100scale_nb2_mce_bp_${seed}
python train_bp.py --aug 1 --n_classes 10 --no_bias 1 --seed $seed --version toy3sss100scale --lr 0.001 --target cifar10_toy3sss100scale_nb2_mce_bp_${seed}
python train_bp.py --aug 1 --n_classes 10 --no_bias 1 --seed $seed --version toy3ssss100scale --lr 0.001 --target cifar10_toy3ssss100scale_nb2_mce_bp_${seed}

# ABP training for mce
python train_cnn01_abp_ce.py --nrows 0.004 --localit 1 --updated_conv_features 32 --updated_fc_features 128 --updated_fc_nodes 1 --updated_conv_nodes 1 --width 100 --normalize 0 --percentile 1 --fail_count 1 --loss mce --act sign --fc_diversity 1 --init normal --no_bias 2 --scale 1 --w-inc1 0.0045 --w-inc2 0.1 --version toy3srr100scale --seed $seed --iters 30000 --dataset cifar10 --n_classes 10 --cnn 1 --divmean 0 --target cifar10_toy3srr100scale_abp_sign_i1_mce_b200_lrc0.0045_lrf0.1_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed} --updated_fc_ratio 10 --updated_conv_ratio 20 --verbose_iter 500 --freeze_layer 0 --lr 0.001 --bp_layer 4 --aug 1
python train_cnn01_abp_ce.py --nrows 0.004 --localit 1 --updated_conv_features 32 --updated_fc_features 128 --updated_fc_nodes 1 --updated_conv_nodes 1 --width 100 --normalize 0 --percentile 1 --fail_count 1 --loss mce --act sign --fc_diversity 1 --init normal --no_bias 2 --scale 1 --w-inc1 0.0045 --w-inc2 0.05 --version toy3ssr100scale --seed $seed --iters 30000 --dataset cifar10 --n_classes 10 --cnn 1 --divmean 0 --target cifar10_toy3ssr100scale_abp_sign_i1_mce_b200_lrc0.0045_lrf0.05_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed} --updated_fc_ratio 10 --updated_conv_ratio 20 --verbose_iter 500 --freeze_layer 1 --resume --source cifar10_toy3srr100scale_abp_sign_i1_mce_b200_lrc0.0045_lrf0.1_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed} --lr 0.001 --bp_layer 3  --aug 1  --reinit 3
python train_cnn01_abp_ce.py --nrows 0.004 --localit 1 --updated_conv_features 32 --updated_fc_features 128 --updated_fc_nodes 1 --updated_conv_nodes 1 --width 100 --normalize 0 --percentile 1 --fail_count 1 --loss mce --act sign --fc_diversity 1 --init normal --no_bias 2 --scale 1 --w-inc1 0.05 --w-inc2 0.05 --version toy3sss100scale --seed $seed --iters 30000 --dataset cifar10 --n_classes 10 --cnn 1 --divmean 0 --target cifar10_toy3sss100scale_abp_sign_i1_mce_b200_lrc0.05_lrf0.05_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed} --updated_fc_ratio 10 --updated_conv_ratio 20 --verbose_iter 500 --freeze_layer 2 --resume --source cifar10_toy3ssr100scale_abp_sign_i1_mce_b200_lrc0.0045_lrf0.05_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed}  --lr 0.001 --bp_layer 2  --aug 1  --reinit 2
python train_cnn01_abp_ce.py --nrows 0.004 --localit 1 --updated_conv_features 32 --updated_fc_features 128 --updated_fc_nodes 1 --updated_conv_nodes 1 --width 100 --normalize 0 --percentile 1 --fail_count 1 --loss mce --act sign --fc_diversity 1 --init normal --no_bias 2 --scale 1 --w-inc1 0.05 --w-inc2 0.7 --version toy3ssss100scale --seed $seed --iters 30000 --dataset cifar10 --n_classes 10 --cnn 1 --divmean 0 --target cifar10_toy3ssss100scale_abp_sign_i1_mce_b200_lrc0.05_lrf0.7_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed} --updated_fc_ratio 10 --updated_conv_ratio 20 --verbose_iter 500 --freeze_layer 3 --resume --source cifar10_toy3sss100scale_abp_sign_i1_mce_b200_lrc0.05_lrf0.05_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed} --lr 0.001 --bp_layer 1  --aug 1  --reinit 1

# ABP adversarial training for mce
python train_cnn01_abp_ce.py --nrows 0.004 --localit 1 --updated_conv_features 32 --updated_fc_features 128 --updated_fc_nodes 1 --updated_conv_nodes 1 --width 100 --normalize 0 --percentile 1 --fail_count 1 --loss mce --act sign --fc_diversity 1 --init normal --no_bias 2 --scale 1 --w-inc1 0.0045 --w-inc2 0.1 --version toy3srr100scale --seed $seed --iters 30000 --dataset cifar10 --n_classes 10 --cnn 1 --divmean 0 --target cifar10_toy3srr100scale_abp_adv_sign_i1_mce_b200_lrc0.0045_lrf0.1_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed} --updated_fc_ratio 10 --updated_conv_ratio 20 --verbose_iter 500 --freeze_layer 0 --lr 0.001 --bp_layer 4 --aug 1 --adv_train 1
python train_cnn01_abp_ce.py --nrows 0.004 --localit 1 --updated_conv_features 32 --updated_fc_features 128 --updated_fc_nodes 1 --updated_conv_nodes 1 --width 100 --normalize 0 --percentile 1 --fail_count 1 --loss mce --act sign --fc_diversity 1 --init normal --no_bias 2 --scale 1 --w-inc1 0.0045 --w-inc2 0.05 --version toy3ssr100scale --seed $seed --iters 30000 --dataset cifar10 --n_classes 10 --cnn 1 --divmean 0 --target cifar10_toy3ssr100scale_abp_adv_sign_i1_mce_b200_lrc0.0045_lrf0.05_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed} --updated_fc_ratio 10 --updated_conv_ratio 20 --verbose_iter 500 --freeze_layer 1 --resume --source cifar10_toy3srr100scale_abp_adv_sign_i1_mce_b200_lrc0.0045_lrf0.1_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed} --lr 0.001 --bp_layer 3  --aug 1  --reinit 3 --adv_train 1
python train_cnn01_abp_ce.py --nrows 0.004 --localit 1 --updated_conv_features 32 --updated_fc_features 128 --updated_fc_nodes 1 --updated_conv_nodes 1 --width 100 --normalize 0 --percentile 1 --fail_count 1 --loss mce --act sign --fc_diversity 1 --init normal --no_bias 2 --scale 1 --w-inc1 0.05 --w-inc2 0.05 --version toy3sss100scale --seed $seed --iters 30000 --dataset cifar10 --n_classes 10 --cnn 1 --divmean 0 --target cifar10_toy3sss100scale_abp_adv_sign_i1_mce_b200_lrc0.05_lrf0.05_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed} --updated_fc_ratio 10 --updated_conv_ratio 20 --verbose_iter 500 --freeze_layer 2 --resume --source cifar10_toy3ssr100scale_abp_adv_sign_i1_mce_b200_lrc0.0045_lrf0.05_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed}  --lr 0.001 --bp_layer 2  --aug 1  --reinit 2 --adv_train 1
python train_cnn01_abp_ce.py --nrows 0.004 --localit 1 --updated_conv_features 32 --updated_fc_features 128 --updated_fc_nodes 1 --updated_conv_nodes 1 --width 100 --normalize 0 --percentile 1 --fail_count 1 --loss mce --act sign --fc_diversity 1 --init normal --no_bias 2 --scale 1 --w-inc1 0.05 --w-inc2 0.7 --version toy3ssss100scale --seed $seed --iters 30000 --dataset cifar10 --n_classes 10 --cnn 1 --divmean 0 --target cifar10_toy3ssss100scale_abp_adv_sign_i1_mce_b200_lrc0.05_lrf0.7_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed} --updated_fc_ratio 10 --updated_conv_ratio 20 --verbose_iter 500 --freeze_layer 3 --resume --source cifar10_toy3sss100scale_abp_adv_sign_i1_mce_b200_lrc0.05_lrf0.05_nb2_nw0_dm0_upc1_upf1_ucf32_normal_${seed} --lr 0.001 --bp_layer 1  --aug 1 --reinit 1 --adv_train 1


done



# combine votes

python combine_vote_new.py --dataset cifar10 --n_classes 10 --votes 8 --no_bias 1 --scale 1 --cnn 1 --version toy3rrr100 --act sign --target cifar10_toy3rrr100_nb2_mce_bp --save

python combine_vote_new.py --dataset cifar10 --n_classes 10 --votes 8 --no_bias 1 --scale 1 --cnn 1 --version toy3srr100scale --act sign --target cifar10_toy3srr100scale_nb2_mce_bp --save
python combine_vote_new.py --dataset cifar10 --n_classes 10 --votes 8 --no_bias 1 --scale 1 --cnn 1 --version toy3ssr100scale --act sign --target cifar10_toy3ssr100scale_nb2_mce_bp --save
python combine_vote_new.py --dataset cifar10 --n_classes 10 --votes 8 --no_bias 1 --scale 1 --cnn 1 --version toy3sss100scale --act sign --target cifar10_toy3sss100scale_nb2_mce_bp --save
python combine_vote_new.py --dataset cifar10 --n_classes 10 --votes 8 --no_bias 1 --scale 1 --cnn 1 --version toy3ssss100scale --act sign --target cifar10_toy3ssss100scale_nb2_mce_bp --save


python combine_vote_new.py --dataset cifar10 --n_classes 10 --votes 8 --no_bias 1 --scale 1 --cnn 1 --version toy3srr100scale --act sign --target cifar10_toy3srr100scale_abp_sign_i1_mce_b200_lrc0.0045_lrf0.1_nb2_nw0_dm0_upc1_upf1_ucf32_normal --save
python combine_vote_new.py --dataset cifar10 --n_classes 10 --votes 8 --no_bias 1 --scale 1 --cnn 1 --version toy3ssr100scale --act sign --target cifar10_toy3ssr100scale_abp_sign_i1_mce_b200_lrc0.0045_lrf0.05_nb2_nw0_dm0_upc1_upf1_ucf32_normal --save
python combine_vote_new.py --dataset cifar10 --n_classes 10 --votes 8 --no_bias 1 --scale 1 --cnn 1 --version toy3sss100scale --act sign --target cifar10_toy3sss100scale_abp_sign_i1_mce_b200_lrc0.05_lrf0.05_nb2_nw0_dm0_upc1_upf1_ucf32_normal --save
python combine_vote_new.py --dataset cifar10 --n_classes 10 --votes 8 --no_bias 1 --scale 1 --cnn 1 --version toy3ssss100scale --act sign --target cifar10_toy3ssss100scale_abp_sign_i1_mce_b200_lrc0.05_lrf0.7_nb2_nw0_dm0_upc1_upf1_ucf32_normal --save


python combine_vote_new.py --dataset cifar10 --n_classes 10 --votes 8 --no_bias 1 --scale 1 --cnn 1 --version toy3srr100scale --act sign --target cifar10_toy3srr100scale_abp_adv_sign_i1_mce_b200_lrc0.0045_lrf0.1_nb2_nw0_dm0_upc1_upf1_ucf32_normal --save
python combine_vote_new.py --dataset cifar10 --n_classes 10 --votes 8 --no_bias 1 --scale 1 --cnn 1 --version toy3ssr100scale --act sign --target cifar10_toy3ssr100scale_abp_adv_sign_i1_mce_b200_lrc0.0045_lrf0.05_nb2_nw0_dm0_upc1_upf1_ucf32_normal --save
python combine_vote_new.py --dataset cifar10 --n_classes 10 --votes 8 --no_bias 1 --scale 1 --cnn 1 --version toy3sss100scale --act sign --target cifar10_toy3sss100scale_abp_adv_sign_i1_mce_b200_lrc0.05_lrf0.05_nb2_nw0_dm0_upc1_upf1_ucf32_normal --save
python combine_vote_new.py --dataset cifar10 --n_classes 10 --votes 8 --no_bias 1 --scale 1 --cnn 1 --version toy3ssss100scale --act sign --target cifar10_toy3ssss100scale_abp_adv_sign_i1_mce_b200_lrc0.05_lrf0.7_nb2_nw0_dm0_upc1_upf1_ucf32_normal --save

